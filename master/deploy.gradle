ext {
    tempDistsDir = "$distsDir/temp"
}

subprojects{

    ext {
        outerResourcesDir = 'OuterResouces'

        shellDir = 'Shell'
        confDir = 'Conf'
        archivesDir = 'Java'

    }

    task copyOuterResoucesToDists << {

        copy {
            def outerShellDir = "$outerResourcesDir/$shellDir"

            from outerShellDir
            from "$outerShellDir$stageNo"
            into "$distsDir/$shellDir"
        }

        copy {
            def outerConfDir = "$outerResourcesDir/$confDir"

            from outerConfDir
            from "$outerConfDir$stageNo"
            into "$distsDir/$confDir"
        }
    }
}

task copyDistsToMaster <<  {

    subprojects.each { subProject ->

         copy {
            from subProject.distsDir
            into tempDistsDir
        }
    }
}

task zipDists(type: Zip, dependsOn: copyDistsToMaster)  {
    archiveName = String.format('dists-%s.zip', new Date().format('yyyyMMdd'));
    from tempDistsDir
}
